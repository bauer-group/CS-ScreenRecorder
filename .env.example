# =============================================================================
# Cap Screen Recorder - Self-Hosted [BAUER GROUP Edition]
# =============================================================================
# Documentation: https://cap.so/docs/self-hosting
# Repository: https://github.com/CapSoftware/Cap
#
# This file contains all configuration options for Cap self-hosted deployment.
# Copy this file to .env and adjust values as needed.
#
# IMPORTANT: Run ./scripts/generate-secrets.sh to generate secure passwords!
# =============================================================================

# -----------------------------------------------------------------------------
# STACK IDENTIFICATION
# -----------------------------------------------------------------------------

# Unique name for this deployment (used in container names, volumes, networks)
# Use lowercase, alphanumeric with underscores only
STACK_NAME=screenrecorder_app_bauer-group_com

# Timezone for all services
TIME_ZONE=Etc/UTC

# -----------------------------------------------------------------------------
# VERSION CONFIGURATION
# -----------------------------------------------------------------------------

# Cap Web application version (for custom branded image)
# Check GHCR for available tags
CAP_VERSION=latest

# MySQL version (8.0+ required)
MYSQL_VERSION=8.0

# MinIO version
MINIO_VERSION=latest

# -----------------------------------------------------------------------------
# NETWORK CONFIGURATION
# -----------------------------------------------------------------------------

# -- Development Mode --
# Direct port exposure (no reverse proxy)
EXPOSED_APP_PORT=3000
EXPOSED_MYSQL_PORT=3306
EXPOSED_MINIO_API_PORT=9000
EXPOSED_MINIO_CONSOLE_PORT=9001

# -- Production Mode (Traefik) --
# DNS must resolve to these hostnames
SERVICE_HOSTNAME=screenrecorder.app.bauer-group.com
S3_HOSTNAME=assets.screenrecorder.app.bauer-group.com
S3_CONSOLE_HOSTNAME=assets-console.screenrecorder.app.bauer-group.com

# External Traefik network name
PROXY_NETWORK=EDGEPROXY

# -----------------------------------------------------------------------------
# CAP APPLICATION SETTINGS
# -----------------------------------------------------------------------------

# Public URL of the Cap server (REQUIRED)
# This is used for generating share links and OAuth callbacks
# Development: http://localhost:3000
# Production: https://screenrecorder.app.bauer-group.com
WEB_URL=https://screenrecorder.app.bauer-group.com

# Node environment
NODE_ENV=production

# Default visibility for new videos
# true = public by default, false = private by default
CAP_VIDEOS_DEFAULT_PUBLIC=true

# Restrict signups to specific email domains (comma-separated)
# Leave empty to allow all domains
# Example: bauer-group.com,example.com
CAP_ALLOWED_SIGNUP_DOMAINS=

# -----------------------------------------------------------------------------
# AUTHENTICATION SECRETS (REQUIRED)
# -----------------------------------------------------------------------------
# Run ./scripts/generate-secrets.sh to generate these values!

# NextAuth secret (32 byte base64 string) (REQUIRED)
# Used for encrypting session tokens
# Generate: openssl rand -base64 32
NEXTAUTH_SECRET=

# Database encryption key (32 byte hex string)
# Used for encrypting sensitive data like AWS access keys stored in database
# Generate: openssl rand -hex 32
DATABASE_ENCRYPTION_KEY=

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION (MySQL)
# -----------------------------------------------------------------------------
# Note: Database name and user are static in compose files (cap/cap)

# Database password (REQUIRED)
# Run ./scripts/generate-secrets.sh to generate
DATABASE_PASSWORD=

# Database connection pool size
DATABASE_POOL_SIZE=20

# -----------------------------------------------------------------------------
# S3 STORAGE CONFIGURATION (MinIO)
# -----------------------------------------------------------------------------
# Note: Bucket name (videos), service user (cap), and region (global) are
# static in compose files - no configuration needed.

# MinIO root credentials (admin access)
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=

# S3 service account secret key (for Cap application)
CAP_AWS_SECRET_KEY=

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION (Optional)
# -----------------------------------------------------------------------------
# If not configured, login links will be written to server logs.

# Resend.com API key
# Sign up at https://resend.com and create an API key
RESEND_API_KEY=

# Domain for sending emails (must be verified in Resend)
# Example: mail.bauer-group.com
RESEND_FROM_DOMAIN=

# -----------------------------------------------------------------------------
# OAUTH PROVIDERS (Optional)
# -----------------------------------------------------------------------------

# Google OAuth
# Create credentials at https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# WorkOS (Enterprise SSO)
# Sign up at https://workos.com
WORKOS_CLIENT_ID=
WORKOS_API_KEY=

# -----------------------------------------------------------------------------
# AI FEATURES (Optional)
# -----------------------------------------------------------------------------

# Audio transcription (Deepgram)
# Sign up at https://deepgram.com
DEEPGRAM_API_KEY=

# AI summaries - use ONE of the following:
# OpenAI: https://platform.openai.com/api-keys
OPENAI_API_KEY=

# Groq (faster, cheaper alternative): https://console.groq.com
GROQ_API_KEY=

# -----------------------------------------------------------------------------
# PAYMENTS (Optional)
# -----------------------------------------------------------------------------

# Stripe integration
# Get keys at https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# INTEGRATIONS (Optional)
# -----------------------------------------------------------------------------

# Discord webhooks for notifications
DISCORD_FEEDBACK_WEBHOOK_URL=
DISCORD_LOGS_WEBHOOK_URL=

# Analytics
TINYBIRD_HOST=
TINYBIRD_TOKEN=

# URL shortener
DUB_API_KEY=

# Customer communication
INTERCOM_SECRET=

# PostHog product analytics
POSTHOG_PERSONAL_API_KEY=

# -----------------------------------------------------------------------------
# CLOUDFRONT CDN (Optional)
# -----------------------------------------------------------------------------
# For production deployments with high traffic

CAP_CLOUDFRONT_DISTRIBUTION_ID=
CLOUDFRONT_KEYPAIR_ID=
CLOUDFRONT_KEYPAIR_PRIVATE_KEY=

# -----------------------------------------------------------------------------
# WORKFLOW SYSTEM (Optional)
# -----------------------------------------------------------------------------

WORKFLOWS_RPC_URL=
WORKFLOWS_RPC_SECRET=

# -----------------------------------------------------------------------------
# ACCESS POINTS
# -----------------------------------------------------------------------------
#
# Development:
#   App:           http://localhost:3000
#   MinIO API:     http://localhost:9000
#   MinIO Console: http://localhost:9001
#
# Production:
#   App:           https://screenrecorder.app.bauer-group.com
#   S3 API:        https://assets.screenrecorder.app.bauer-group.com
#   MinIO Console: https://assets-console.screenrecorder.app.bauer-group.com
#
